{
N_bob =
2843320233792542251053357394068088686668524975752636080093537940
4832527514764874620628848105181825527933880102457169730719923244
6420151499813375523635289637990354962034693574665424583399133573
0583501632679081431737342001818666796295631297455573102373116440
3029788484704936984714437598885024284453243844454411794042986345
2670573135811710297531056679013108703134713805990185300653031156
4180092399756052224998536204529486287954472923574337261846322017
890592838801890702039;

E_bob =
2291100640658304898982037736299578548614658498374369307423059101
7753909793205446710905103866626852874140382358105613997851675753
6616368494790527495119970061488145079661142528335377919451554688
6154257484268335107367291548215957325536731933203947342597628607
0538102530714442994442646163672237217358454654896394943346204459
0665520882478282704144094054610779463057719130141630088734441774
4643471937489057261616554090115047189679240761528659032842549170
461539414559766262563;

N_alice =
5686640467585084502106714788136177373337049951505272160187075880
9665055029529749241257696210363651055867760204914339461439846489
2840302999626752018801395151071678016047051400133923004670186013
9988684396623348180130983267413984406693145186191663434333107341
4271159645546495517290635898239652290125489708412903139175746507
8882509062160255488830168051051374738819714402801269575387131769
8468196572196081277369024478340281325985826876817304126462736931
162058746229329458443;

E_alice =
5532204639026134156498081092471471626870989697962125080810121970
0937589706597407035452447205974152734582820015569746612727007206
2814426400049844220852036436793883376956881347807180964186086536
6805991700540784345980142718081120280543581590237686483113697701
6509366984984445443725555441703117867313078723749470914317101582
9520122197714627967971392769730377826127068782925537780549266077
9768718083990120844013377666526983516809292705750575751662270100
621679600058468454699;

M_AtoB =
1396364112413623642374178953014019904568061507434558505408267555
8231810369233960158591102037668709444252754006802542256490072017
0291609574950964015823622596731476468470628411816615719782348534
7273167553704712490006234283555813449834048635758312335972910209
5849958053264948388306938543259511664955402250394909679552507339
2828805017197137725781299915845926173013085987451784686823149814
4313379547441762202636503884816587950694638762568426358881638049
169947376779771961136;


g = gcd(N_bob, N_alice);
p_bob = N_bob / g; q_bob = g;
p_alice = N_alice / g; q_alice = g;
phi_bob = (p_bob - 1) * (q_bob - 1);
d_bob = lift(1 / Mod(E_bob, phi_bob));
phi_alice = (p_alice - 1) * (q_alice - 1);
d_alice = lift(1 / Mod(E_alice, phi_alice));

M_AtoB_D = lift(Mod(M_AtoB, N_bob) ^ d_bob);
M_AtoB_DText = Strchr(digits(M_AtoB_D, 256));
print(M_AtoB_DText);

/*
See p72. What are the least number of steps to goal 453071286 for the following states?
674823510,048726351,286407351,274683510,637082451,037826451,268307451,237684510
Answer format: s1,s2,..,s8
*/


/* 21,25,29,19,24,25,27,19 */
BtoA_Text = "21,25,29,19,24,25,27,19";
M_BtoA = fromdigits(Vec(Vecsmall(BtoA_Text)), 256);
M_BtoA_E = lift(Mod(M_BtoA, N_alice) ^ E_alice);

str_M_BtoA_E = Vec(Str(M_BtoA_E));
ans = concat(str_M_BtoA_E[1..100]);
print(ans);    \\ 3820748472426233962486085385967664982161598429194188225867065506534766722859361718267846429497819221
}
