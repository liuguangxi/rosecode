chk(p) = {
    fordiv (P, d,
        if (d == P && lift(Mod(10, p)^d) == 1, return(1));
        if (lift(Mod(10, p)^d) == 1, return(0));
    );
    return(0);
}


{
P = 798;
fa = factor(x^798 - 1); lfa = #fa[,1];
vv = []; vp = [];
for (i = 1, lfa,
    vv = concat(vv, subst(fa[i,1], x, 10));
    fi = factor(subst(fa[i,1], x, 10), 10^8);
    vp = concat(vp, fi[,1]);
);
vp = Set(vp); lvp = #vp;
\\print(vp);
for (i = 1, lvp,
    p = vp[i];
    if (chk(p), print("Candidate: ", p));
);

/*
910000091000000000090090009008999999999909909990990999999090089999009008999909909900900990991000090090099099009009909910000900900990990090089999099098999909909000000900900090089999999999099099909910000000000910000091 =
425991366045253 *
17499101101496101893247811440257935152097401 *
9284668536078237580134472469990637899155265743957 *
13147963643704652632557279758698587212033283223333451187877069162714784603584406816150353817835190742091970171
*/
ans = 425991366045253;
print(ans);
}
