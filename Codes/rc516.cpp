/*
#Iter = 307    G(2, 1) = 245836727707164139860503406
#Iter = 261    G(3, 2) = 14594806928344877201586529376529
#Iter = 246    G(4, 3) = 15748232984307748837764857810353136
#Iter = 342    G(5, 4) = 2638764296580051290681088117086395150
#Iter = 592    G(6, 5) = 190237049180513373562097710244346807792
#Iter = 345    G(7, 6) = 10557867356204595891962003639273295881439
#Iter = 163    G(8, 7) = 159468719083729630513125425781557345816160
#Iter = 176    G(9, 8) = 1968342330967534074889431199587951302442120
#Iter = 194    G(10, 9) = 20856331704505859095838765819299911447198230
#Iter = 223    G(11, 10) = 187230674651706984791699553597681605730399635
#Iter = 205    G(12, 11) = 1547218939476853135208157423540467753666783652
#Iter = 300    G(13, 12) = 12371468913440140375947833682785356658993387362
#Iter = 339    G(14, 13) = 41982936079219416198065608261884804387812885746
#Iter = 250    G(15, 14) = 192473844176550878964132269130657742026149064180
#Iter = 273    G(16, 15) = 1247791387110462353442557998116386158922844104480
#Iter = 268    G(17, 16) = 2950728536130532578349743908225990556791690343051
#Iter = 194    G(18, 17) = 14276880948564609584843736907213969798556855283594
#Iter = 243    G(19, 18) = 37086569249500313349221100816906595389788993470857
#Iter = 161    G(20, 19) = 145698204872197396017731661020233907610310839458900
#Iter = 230    G(21, 20) = 318596454055542647936098502302751199745507782274476
#Iter = 168    G(22, 21) = 1327849306887838025162485299553323267302419370589620
#Iter = 182    G(23, 22) = 2498193605793300488793934507189174273545168426831144
#Iter = 343    G(24, 23) = 10482087235597932386826362176764586361156582433207576
#Iter = 267    G(25, 24) = 17249946321045995328489854216717449948327302722039125
#Iter = 333    G(26, 25) = 38247146635128058096340262417490027537482691871168376
#Iter = 163    G(27, 26) = 128063986775193863407670625230198940223327268143853181
#Iter = 191    G(28, 27) = 193684424591300170021346529529088647631931543523574884
#Iter = 205    G(29, 28) = 431058967162295336422631701637756909348318676190974816
#Iter = 135    G(30, 29) = 1290453789114765967145048822178202240928686549705613700
#Iter = 162    G(31, 30) = 1860369461597842949990633834994222794764837784661119206
#Iter = 259    G(32, 31) = 3724976598179002276063294987733250726083459080793215744
#Iter = 186    G(33, 32) = 10885439670753472659157010661045487923210162809476322019
#Iter = 151    G(34, 33) = 16028297514628031482507042270965040419736425875624551550
#Iter = 159    G(35, 34) = 25983675401785754766896730624291065502110560590141359580
#Iter = 425    G(36, 35) = 60457432807935900491669843310230370334064272275013437228
#Iter = 164    G(37, 36) = 129674456489334523120478632083277300653150167073424295329
#Iter = 167    G(38, 37) = 173894263748112609585091763982937507315751795005575962406
#Iter = 219    G(39, 38) = 276092356842570097591652783888940057624113586910009585788
#Iter = 410    G(40, 39) = 618530445532819116197171198458681774693419558527693518680
#Iter = 161    G(41, 40) = 1276703949498625723855281240565927479106907768959768653982
#Iter = 129    G(42, 41) = 1642593630383673378641779101677175422284423960948754373012
#Iter = 224    G(43, 42) = 2468050761269624403302881755596287713388649522618839828717
#Iter = 318    G(44, 43) = 4173629242072065638853693431604193371096825900124725911456
#Iter = 179    G(45, 44) = 10591486377901269227500034946118253989741287960115471130415
#Iter = 144    G(46, 45) = 14070629038612150064757157022715037057212603913919203560384
#Iter = 194    G(47, 46) = 18043979807656377886203794771127631041646645276532133246078
#Iter = 198    G(48, 47) = 26837955433215767808502865770218486070694123512210997792256
#Iter = 449    G(49, 48) = 47905302368398451378806577980218165057844910784157826466167
#Iter = 257    G(50, 49) = 106383079520392063612154645036313239510976098758479522383550
#Iter = 130    G(51, 50) = 138709045172214976168257422801163792135976482057678541677006
#Iter = 148    G(52, 51) = 172846695414342409125311719726130762040645805164290856189168
#Iter = 234    G(53, 52) = 243830756819130332496342714167189604394979916802753114837373
#Iter = 255    G(54, 53) = 370650974850187255317354665408673232549722662637401428544328
#Iter = 374    G(55, 54) = 751270693482614054195364048887379601803253277694306629201495
#Iter = 150    G(56, 55) = 1250869215764597036153351835298331916829903663423400605382952
#Iter = 225    G(57, 56) = 1483590005957621254382708416156141853857233561218948617240926
#Iter = 154    G(58, 57) = 1826033594389047769580684003655623246890040518773281376933804
#Iter = 156    G(59, 58) = 2518940614369927611673952567242509552095102242925632413048435
#Iter = 219    G(60, 59) = 3729654096983443373316442404833654293409382203991322034045760
#Iter = 348    G(61, 60) = 7156940763287248145924936627516845748123483433955203102389687
#Iter = 208    G(62, 61) = 12054988267364838212523415402552217175527838221264884845742926
#Iter = 275    G(63, 62) = 14057604531728315429551758054778275857136187777721551806899889
#Iter = 152    G(64, 63) = 16806452773811299169211058833864133230802527525602851944593216
#Iter = 299    G(65, 64) = 20696586937551647522678628963636088721969306546266286512641520
#Iter = 161    G(66, 65) = 28576440013845932816041365220844773620783935487514200942215058
#Iter = 251    G(67, 66) = 42738930721536941334536894459881771118618073961844893692867740
#Iter = 501    G(68, 67) = 86374944073292659194761363427126438738029127767214190064343432
#Iter = 175    G(69, 68) = 124036454529780038124288992755091471100894232986586941817737237
#Iter = 98    G(70, 69) = 140892317516781655178414880941226910662267731905184669768876540
#Iter = 96    G(71, 70) = 165074933821160807193575204731383894544773518225715831812559825
#Iter = 213    G(72, 71) = 197094628169950422803333999334239489029437181653972586597454856
#Iter = 222    G(73, 72) = 265375954174089614088016512944877522276996944235074258285202883
#Iter = 201    G(74, 73) = 371650488639178822338516937000999210539176402073622979654837300
#Iter = 384    G(75, 74) = 604391869017365323854282885137613788284728432297901365012494025
#Iter = 227    G(76, 75) = 1055836716298550963649478134312372810040822654866844297724975608
#Iter = 131    G(77, 76) = 1285377303644016955098458281566039735430238318583829572033651761
#Iter = 223    G(78, 77) = 1468049757585359756195244692105538626298980471134328068200176484
#Iter = 153    G(79, 78) = 1689437499059431587279095851072850241995291719380884876646350493
#Iter = 122    G(80, 79) = 1976470835622230394867509031265804185440273169910112540052624080
#Iter = 144    G(81, 80) = 2605989414731927668420072628558206004805700120778580299025201744
#Iter = 183    G(82, 81) = 3291450827465830891933619790070744740268281695192849725176615260
#Iter = 299    G(83, 82) = 5087672425934349184916103864994135419167313297046193217115064385
#Iter = 405    G(84, 83) = 9583270026924461580680882751277314985690713240489671971594382184
#Iter = 207    G(85, 84) = 12085836142431777593907747205493510125542506041446759058097170335
#Iter = 108    G(86, 85) = 13608349825044770152604783428381285488030137070877091277346672552
#Iter = 221    G(87, 86) = 15308198044280370269797250443409099061584580359390382461008922412
#Iter = 160    G(88, 87) = 17468323786954303498791820413844169273393085017097402760195987896
#Iter = 155    G(89, 88) = 20516943264800688275924049717259366677917364441066350411162759661
#Iter = 130    G(90, 89) = 26150879234222453758175121355319347317812855545885708675938682470
#Iter = 181    G(91, 90) = 32169882745776650858703441340762355606242611255780376936229492928
#Iter = 360    G(92, 91) = 47935783673217063573165303595643558852553727158280128773982958176
#Iter = 357    G(93, 92) = 75406197736378792938041011259967708521957185599145463885208026439
#Iter = 165    G(94, 93) = 107386623775234877939356173455936965896451496040589792125243997608
#Iter = 123    G(95, 94) = 128470761215934585554379273548144067595505459984126632159944192665
#Iter = 198    G(96, 95) = 142751023943095631867537977907838114204373571820935791978264135584
#Iter = 159    G(97, 96) = 159305624581352992827408415705037210933789556516772706247585830301
#Iter = 160    G(98, 97) = 180357402290248475316463463250740015478496137577670908448562592960
#Iter = 169    G(99, 98) = 208168748099038590133809879954891172342447592894262082358903641293
#Iter = 300    G(100, 99) = 263840194012255596997216086104127904808639810975889474107236949800
S = 1481084027819833139193548557199179274375042469888601290096385808324
S mod 1000000033 = 275011389

execution time : 259.791 s
*/


#include <iostream>
#include <string>
#include <vector>
#include <algorithm>
#include <gmpxx.h>

using namespace std;


mpz_class pan_num(mpz_class n)
{
    mpz_class s = 0;
    vector<mpz_class> f(1024);
    vector<mpz_class> f2(1024);
    string strn = n.get_str();
    int ndig = (int)strn.size();
    vector<int> vn;
    for (char c : strn)
        vn.push_back((int)(c - '0'));

    // [1, 10^(ndig-1)-1]
    fill(f.begin(), f.end(), 0);
    for (int x = 1; x <= 9; x++)
        f[1 << x] = 1;
    for (int i = 1; i <= ndig - 2; i++) {
        fill(f2.begin(), f2.end(), 0);
        for (int j = 1; j <= 1023; j++) {
            if (f[j] == 0)
                continue;
            for (int k = 0; k <= 9; k++)
                f2[j | (1 << k)] += f[j];
        }
        swap(f, f2);
        s += f[1023];
    }

    // [10^(ndig-1), N]
    unsigned mask = 0;
    fill(f.begin(), f.end(), 0);
    for (int i = 0; i <= ndig - 1; i++) {
        int kmin = (i == 0) ? 1 : 0;
        int kmax = (i == ndig - 1) ? vn[i] : (vn[i] - 1);
        for (int k = kmin; k <= kmax; k++)
            f[mask | (1 << k)]++;
        if (i < ndig - 1) {
            fill(f2.begin(), f2.end(), 0);
            for (int j = 1; j <= 1023; j++) {
                if (f[j] == 0)
                    continue;
                for (int k = 0; k <= 9; k++)
                    f2[j | (1 << k)] += f[j];
            }
            swap(f, f2);
            mask |= (1 << vn[i]);
        }
    }
    s += f[1023];

    return s;
}


void calc()
{
    mpz_class s = 0;
    mpz_class n0("200000000000000000000000000");
    mpz_class s0;
    mpz_class d;
    int niter;
    for (int i = 2; i <= 100; i++) {
        niter = 0;
        while (1) {
            niter++;
            s0 = pan_num(n0);
            d = n0 * (i-1) - s0 * i;
            if (d <= 0)
                break;
            n0 += d;
        }
        s += n0;
        cout << "#Iter = " << niter << "    G(" << i << ", " << i - 1 << ") = " << n0 << endl;
    }
    cout << "S = " << s << endl;
    cout << "S mod 1000000033 = " << s % 1000000033 << endl;
}


int main()
{
    calc();

    return 0;
}
